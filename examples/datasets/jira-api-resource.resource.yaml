kind: "Resource"
metadata:
  name: "jira-api-resource"
spec:
  store:
    format: "http"
    location: "${JIRA_APP_URL}/rest/api/3/search/jql"
    options:
      method: "POST"
      timeout: 30000
      retries: 3
      extractArray: "issues"
      noVerifySsl: false
      logResponse: true
      headers:
        Content-Type: "application/json"
      pagination:
        enabled: true
        type: "cursor"

        cursor:
          responseField: "nextPageToken"
          requestParam: "nextPageToken"
          paramLocation: "query"

        stopConditions:
          - field: "nextPageToken"
            condition: "null_or_empty"
          - field: "isLast"
            condition: "true"

        maxPages: 10
        maxRecords: 1000

      body: |
        {
          "jql": "project = AB",
          "fields": ["*all"]
        }
